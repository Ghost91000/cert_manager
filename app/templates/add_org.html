{% extends "base.html" %}
{% block content %}

    <h1>Добавить организацию</h1>

    <form>
        <input id="js-name" type="text" name="name" placeholder="Имя" required><br><br>
        <input id="js-url" type="url" name="url" placeholder="URL" required><br><br>

        <button onclick="add()">Добавить</button>
    </form>
    <div id="list-org">
        {% include "list_org_partical.html" %}
    </div>
    <div style="margin-top: 20px;">
        <button onclick="refreshTable()">Обновить таблицу</button>
    </div>
    <br>

    <script>
         async function delete_org(id) {
                const response = await fetch('/delete_org', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `id=${encodeURIComponent(id)}`
                });
                refreshTable()
         }
        async function add() {
            const name = document.getElementById('js-name').value;
            const url = document.getElementById('js-url').value;

            if (!name) {
                alert('Введите название!');
                return;
            }

            // Отправляем POST запрос
            const response = await fetch('/add_org', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `name=${encodeURIComponent(name)}&url=${encodeURIComponent(url)}`
                });

            //refreshTable()

            // Очищаем поля
            //document.getElementById('js-name').value = '';
            //document.getElementById('js-url').value = '';
        }

        // Функция обновления таблицы
        async function refreshTable() {
            const response = await fetch('/list_org_partical');
            const html = await response.text();
            document.getElementById('list-org').innerHTML = html;
        }
    </script>
{% endblock %}